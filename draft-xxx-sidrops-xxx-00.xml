<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE rfc [
  <!ENTITY nbsp    "&#160;">
  <!ENTITY zwsp   "&#8203;">
  <!ENTITY nbhy   "&#8209;">
  <!ENTITY wj     "&#8288;">
]>
<?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
<!-- generated by https://github.com/cabo/kramdown-rfc version 1.6.39 (Ruby 3.0.2) -->
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" ipr="trust200902" docName="draft-xxx-sidrops-xxx-00" category="std" consensus="true" submissionType="IETF" version="3">
  <!-- xml2rfc v2v3 conversion 3.18.0 -->
  <front>
    <title abbrev="Multi-Priority Validation">RPKI-based Validation with Prioritized Resource Data</title>
    <!--  [REPLACE/DELETE] abbrev. The abbreviated title is required if the full title is longer than 39 characters -->

    <seriesInfo name="Internet-Draft" value="draft-xxx-sidrops-xxx-00"/>
   

    <author initials="J." surname="Zhang" fullname="Jia Zhang">
        <organization>Zhongguancun Laboratory</organization>
        <address>
          <postal>
            <city>Beijing</city>
            <country>China</country>
          </postal>
          <email>zhangj@mail.zgclab.edu.cn</email>
        </address>
      </author>
    
    <author initials="M." surname="Xu" fullname="Mingwei Xu">
        <organization>CERNET</organization>
        <address>
          <postal>
            <city>Beijing</city>
            <country>China</country>
          </postal>
          <email>xmw@cernet.edu.cn</email>
        </address>
      </author>
    
    <author initials="N." surname="Geng" fullname="Nan Geng">
        <organization>Huawei</organization>
        <address>
          <postal>
            <city>Beijing</city>
            <country>China</country>
          </postal>
          <email>gengnan@huawei.com</email>
        </address>
      </author>
    
    <author initials="C." surname="Xie" fullname="Chongfeng Xie">
        <organization>China Telecom</organization>
        <address>
          <postal>
            <city>Beijing</city>
            <country>China</country>
          </postal>
          <email>xiechf@chinatelecom.cn</email>
        </address>
      </author>

    <author initials="Y." surname="Wang" fullname="Yangyang Wang">
        <organization>Tsinghua University</organization>
        <address>
          <postal>
            <city>Beijing</city>
            <country>China</country>
          </postal>
          <email>wangyy@cernet.edu.cn</email>
        </address>
      </author>
    
    
    
    



    <date year="2025"/>
    <!-- On draft subbmission:
         * If only the current year is specified, the current day and month will be used.
         * If the month and year are both specified and are the current ones, the current day will
           be used
         * If the year is not the current one, it is necessary to specify at least a month and day="1" will be used.
    -->

    <area>Operations and Management Area (OPS)</area>
    <workgroup>SIDR Operations Working Group</workgroup>
    <!-- "Internet Engineering Task Force" is fine for individual submissions.  If this element is 
          not present, the default is "Network Working Group", which is used by the RFC Editor as 
          a nod to the history of the RFC Series. -->

    <keyword>BGP</keyword>
    <keyword>RPKI</keyword>
    <!-- [REPLACE/DELETE]. Multiple allowed.  Keywords are incorporated into HTML output files for 
         use by search engines. -->

    <abstract>
      <t>Based on RPKI ROAs, Route Origin Validation (ROV) provides a practical solution to address prefix origin hijacking. During ROV operations, 
      validation data may be sourced not only from issued ROAs but also from other local sources. These data sources can vary in terms of credibility, 
      and ROV operations may therefore require different response actions for invalid or unknown routes. This document describes an enhancement of ROV 
      with multi-level priority, and outlines relevant use cases, framework, and requirements for ROV operations that involve multi-level priority.</t>
    </abstract>
 
  </front>

  <middle>
    
    <section>
      <name>Introduction</name>
        <t>Route Origin Validation (ROV), which is built on RPKI Route Origin Authorizations (ROAs), stands as a practical and effective approach to 
        combat prefix origin hijacking. In ROV operations, the validating data utilized is not limited to ROAs alone; it may also include various types 
        of local data from other sources. These additional data sources can exhibit varying levels of credibility, with some being highly reliable due 
        to their authoritative origins and others being less trustworthy due to potential inconsistencies or lack of verification. Correspondingly, ROV 
        operations need to be flexible enough to take different actions when dealing with invalid routes and unknown routes. This document introduces an 
        enhancement of ROV with multi-level priority, and elaborates the gap analysis, framework, and specify the key requirements for implementing ROV 
        with multi-level priority in current RPKI infrastructure.</t>

      
      <section>
        <name>Requirements Language</name>
        <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
          "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT
          RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be
          interpreted as described in BCP 14 <xref target="RFC2119"/>
          <xref target="RFC8174"/> when, and only when, they appear in
          all capitals, as shown here.</t>
      </section>
      <!-- [CHECK] The 'Requirements Language' section is optional -->
    </section>
    
  <section>
    <name>Suggested Reading</name>
    <t>
      It is assumed that the reader understands BGP<xref target="RFC4271"/> and RPKI<xref target="RFC6480"/>.
    </t>
  </section>


  <section>
    <name>Gap analysis</name>
    <t>ROV (Route Origin Validation) based on RPKI (Resource Public Key Infrastructure) relies on ROA (Route Origin Authorization) data. It is known 
    that ROA data has the following deployment issues: it does not fully cover all routes in the routing table; there exist ROA data with artificial 
    registration errors; and network operators can filter specific validation data from VRP (Validated ROA Payload) data locally as needed, or supplement 
    it with additional data (e.g., data inferred through machine learning). SLURM (Simplified Local Internet Number Resource Management) technology 
    can be used to modify the data locally.</t>

    <t>Due to such mixed data sources, the credibility of the data varies to different degrees and is no longer uniform. Similarly, network operators 
    expect to perform different operations on validation results based on their credibility. This approach offers benefits such as the following use case: 
    an ISP (Internet Service Provider) uses data derived from its own experience to supplement RPKI ROAs, but the credibility of this supplementary data 
    is lower than that of RPKI ROAs. When a route is verified as "invalid" by RPKI ROAs, the router can discard the route; if a route is verified as 
    "invalid" by supplementary data with medium credibility, the router can be configured to trigger an alert.</t>

    <t>However, current RPKI technology does not support such operations. Regardless of the source of the validation data, the same type of validation 
    result triggers the same operation. This fails to meet the need for customized processing of different scenarios in network operations. This document 
    describes a RPKI validation mechanism with multi-level priority to make RPKI-based validation processing more flexible.</t>
  </section>

  <section>
    <name>Requirements for Multi-Priority RPKI ROV</name>
    <t>This section outlines the requirements for extending the RPKI architecture to support the processing and propagation of RPKI data with 
        multiple priority levels. These requirements are necessary to enable differentiated handling of routing validation results based on their 
        perceived trustworthiness, such as those derived from authoritative sources (e.g., RPKI ROAs) versus inferred or supplemental sources 
        (e.g., AI-generated data).</t>

    <section>
    <name>Priority Setting</name>
    <t>RPKI Relying Party (RP) software MUST support the assignment of a priority level to each validated RPKI object. The priority SHOULD be configurable 
    based on the data source (e.g., RPKI-signed, locally imported, or AI-inferred). The priority value MUST be represented in a standardized format to 
    ensure interoperability.</t>

    </section>

    <section>
    <name>Multi-Priority Data Merge</name>
    <t>When multiple representations of the same prefix-origin pair or customer-provider list exist with different priorities, RP software MUST be capable 
    of merging them according to a consistent policy. The merge policy SHOULD prefer high-priority data and MAY allow low-priority data to be used only when 
    high-priority data is absent.</t>

    </section>

    <section>
    <name>SLURM Support for Priority Marking</name>
    <t>The SLURM mechanism <xref target="RFC8416"/> MUST be extended to allow local exceptions and additions to include a priority attribute. This 
    enables network operators to override or supplement RPKI data with local policies that reflect differentiated trust levels.</t>

    </section>

    <section>
    <name>RTR Support for Priority Marking</name>
    <t>The RPKI-to-Router (RTR) protocol <xref target="RFC8210"/> MUST be extended to convey the assurance level (priority) of the validation 
    data it delivers. This enables routers to apply appropriate local policy based on the trustworthiness of the origin. To provide flexibility 
    in deployment, two implementation models SHALL be supported:</t>

    <t>1. One single local cache server transmits data of multiple assurance levels. The protocol MUST be extended to include a new field within 
    its Protocol Data Units (PDUs) to explicitly carry the assurance level for each payload data item (e.g., a ROA or an ASPA). This model allows 
    a router to maintain a single, simple transport session with one cache server while receiving a mixed-priority data set.</t>

    <t>2. A router establishes transport sessions with multiple local cache servers, where each server is designated to provide data for a 
    specific assurance level (e.g., a primary server provides high-priority RPKI-validated data, and a secondary server provides low-priority supplemental data). 
    The protocol itself remains unchanged, as the priority is derived from the configuration of the router-to-server association.</t>

    <t>Network operators SHOULD choose which implementation to deploy based on their specific operational preferences and infrastructure.</t>

    </section>

    <section>
    <name>ROV/ASPA Validation with Priority Awareness</name>
    <t>ROV and ASPA validation processes MUST be enhanced to support a multi-priority data model. The validation procedure MUST operate 
    as a two-stage process to maximize the utility of available data while respecting the inherent trust level of each source.</t>

    <t>1. Primary Validation with High-Priority Data: The validator MUST first perform validation using only the high-priority data available 
    for a route. The outcome of this primary validation MUST be considered determinative and final if the state is either Valid or Invalid.</t>

    <t>2. Secondary Validation with Low-Priority Data: If and only if the outcome of the primary validation is Unknown, the validator MAY perform 
    a secondary validation using low-priority data. The outcome of this secondary validation (Valid, Invalid, or Unknown) MUST then be adopted as 
    the final validation state for the route.</t>

    <t>Annotation of Validation Outcome: The validation process MUST annotate the resulting validation state (Valid, Invalid) with an indication of 
    the assurance level, which identifies the priority tier of the data that was used to reach that conclusion. For example, an "Invalid" result 
    derived from a local override (high-priority) MUST be distinguishable from an "Invalid" result derived from inferred data (low-priority).</t>

    <t>This annotated validation state MUST then be used to inform subsequent routing policy actions. Implementations SHOULD provide flexible 
    policy mechanisms that allow network operators to define actions (e.g., reject, depreference, warn, accept) based on both the validation 
    state (e.g., Invalid) and its associated assurance level (e.g., High or Low).</t>

    </section>

    <section>
    <name>Router Handling of Priority-Based Invalid Routes</name>
    <t>BGP speakers SHOULD support configurable policies to handle invalid routes based on the priority of the validation data. For example, 
    routes invalidated by high-priority data MAY be deprioritized or discarded, while those invalidated by low-priority data MAY be retained 
    with a warning.</t>

    </section>

    <section>
    <name>BMP Support for Priority in Validation Reports</name>
    <t>The BGP Monitoring Protocol (BMP) <xref target="RFC7854"/> SHOULD be extended to include priority information in reports of ROV/ASPA 
    validation results. This enables network operators to monitor and analyze routing decisions based on data trust levels.</t>

    </section>
            
    </section>


    <section anchor="Security">
      <!-- All drafts are required to have a security considerations section. See RFC 3552 for a guide. -->
      <name>Security Considerations</name>
      <t>
        This document defines a framework for handling RPKI data with multiple levels of priority (assurance), which introduces new considerations 
        beyond those of the base RPKI system <xref target="RFC6480"/>.
      </t>

      <t>Amplification of RPKI Repository Failures: If a high-priority source (e.g., a primary RTR cache) becomes stale or unavailable, the system 
      may fall back to low-priority data. This could lead to a mass re-evaluation of routes from a 'Unknown' state to a 'Valid' or 'Invalid' state based 
      on less trustworthy information, potentially causing widespread routing churn. Implementations should include mechanisms to detect such scenarios 
      and allow operators to define appropriate fallback behaviors.</t>
    </section>

    <section anchor="IANA">
    <!-- All drafts are required to have an IANA considerations section. See RFC 8126 for a guide.-->
      <name>IANA Considerations</name>
      <t>This document has no IANA actions</t>
    </section>
    

    
    <!-- NOTE: The Acknowledgements and Contributors sections are at the end of this template -->
  </middle>

  <back>
    <references>
      <name>References</name>
      <references>
        <name>Normative References</name>
        
        
        <xi:include href="https://www.rfc-editor.org/refs/bibxml/reference.RFC.2119.xml"/>
        <xi:include href="https://www.rfc-editor.org/refs/bibxml/reference.RFC.8174.xml"/>
        <xi:include href="https://www.rfc-editor.org/refs/bibxml/reference.RFC.6480.xml"/>
        <xi:include href="https://www.rfc-editor.org/refs/bibxml/reference.RFC.4271.xml"/>
        <xi:include href="https://www.rfc-editor.org/refs/bibxml/reference.RFC.8893.xml"/>
        <xi:include href="https://www.rfc-editor.org/refs/bibxml/reference.RFC.9234.xml"/>
        <xi:include href="https://www.rfc-editor.org/refs/bibxml/reference.RFC.7854.xml"/>
        <xi:include href="https://www.rfc-editor.org/refs/bibxml/reference.RFC.8210.xml"/>
        <xi:include href="https://www.rfc-editor.org/refs/bibxml/reference.RFC.8416.xml"/>
        

        <!-- The recommended and simplest way to include a well known reference -->

      </references>
 
      <references>
        <name>Informative References</name>
        <reference anchor="I-D.ietf-sidrops-aspa-profile" target="https://datatracker.ietf.org/doc/html/draft-ietf-sidrops-aspa-profile-19">
        <front>
        <title>A Profile for Autonomous System Provider Authorization</title>
        <author initials="A." surname="Azimov" fullname="Alexander Azimov">
        <organization>Yandex</organization>
        </author>
        <author initials="E." surname="Uskov" fullname="Eugene Uskov">
        <organization>JetLend</organization>
        </author>
        <author initials="R." surname="Bush" fullname="Randy Bush">
        <organization>Internet Initiative Japan</organization>
        </author>
        <author initials="J." surname="Snijders" fullname="Job Snijders">
        <organization>Fastly</organization>
        </author>
        <author initials="R." surname="Housley" fullname="Russ Housley">
        <organization>Vigil Security, LLC</organization>
        </author>
        <author initials="B." surname="Maddison" fullname="Ben Maddison">
        <organization>Workonline</organization>
        </author>
        <date month="January" day="6" year="2025"/>
        </front>
        <seriesInfo name="Internet-Draft" value="draft-ietf-sidrops-aspa-profile-19"/>
        </reference>


        <reference anchor="I-D.ietf-sidrops-aspa-verification" target="https://datatracker.ietf.org/doc/html/draft-ietf-sidrops-aspa-verification-22">
        <front>
        <title>BGP AS_PATH Verification Based on Autonomous System Provider Authorization (ASPA) Objects</title>
        <author initials="A." surname="Azimov" fullname="Alexander Azimov">
        <organization>Yandex</organization>
        </author>
        <author initials="E." surname="Bogomazov" fullname="Eugene Bogomazov">
        <organization>Qrator Labs</organization>
        </author>
        <author initials="R." surname="Bush" fullname="Randy Bush">
        <organization>Internet Initiative Japan &amp; Arrcus, Inc.</organization>
        </author>
        <author initials="K." surname="Patel" fullname="Keyur Patel">
        <organization>Arrcus</organization>
        </author>
        <author initials="J." surname="Snijders" fullname="Job Snijders">
        <organization>Fastly</organization>
        </author>
        <author initials="K." surname="Sriram" fullname="Kotikalapudi Sriram">
        <organization>USA National Institute of Standards and Technology</organization>
        </author>
        <date month="March" day="23" year="2025"/>
        </front>
        <seriesInfo name="Internet-Draft" value="draft-ietf-sidrops-aspa-verification-22"/>
        </reference>
      
      </references>
    </references>
    
    
    <!--
    <section>
      <name>Appendix 1 [REPLACE/DELETE]</name>
      <t>This becomes an Appendix [REPLACE]</t>
    </section>
    -->

    <section anchor="Acknowledgements" numbered="false"> 
      <!-- [REPLACE/DELETE] an Acknowledgements section is optional -->
      <name>Acknowledgements</name>
      <t>The authors thank Nan Geng, Sriram Kotikalapudi and Randy Bush for their valuable suggestions and comments.</t>
    </section>

 <!--     <section anchor="Contributors" numbered="false">-->
      <!-- [REPLACE/DELETE] a Contributors section is optional -->
 <!--     <name>Contributors</name>
      <t>Thanks to all of the contributors. [REPLACE]</t>-->
      <!-- [CHECK] it is optional to add a <contact> record for some or all contributors -->
  <!--   </section>
-->


 </back>
</rfc>
